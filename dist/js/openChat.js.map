{"version":3,"file":"openChat.js","sources":["../../src/js/openChat.ts"],"sourcesContent":["/**\n * Level Up Open GHL Chat\n *\n * Auto opens High Level chat widget and adds support for clickable buttons or elements on page to open chat.\n *\n * Usage:\n\n<script type=\"module\">\n  import { openChat } from \"https://cdn.jsdelivr.net/gh/levelupghl/ghlchattools@v1/dist/js/openChat.min.js\";\n  openChat(true, \".open-chat-button\");\n</script>\n\n **/\n\nasync function openWhenChatLoads(): Promise<void> {\n  return new Promise<void>((resolve) => {\n    const handler = (event: LCChatWidgetLoadedEvent) => {\n      resolve()\n      window.removeEventListener(\"LC_chatWidgetLoaded\", handler)\n      openChatWidget()\n    }\n    window.addEventListener(\"LC_chatWidgetLoaded\", handler, false)\n  })\n}\n\nfunction addListeners(selector: string) {\n  document.querySelectorAll(selector).forEach((el) => {\n    el.addEventListener(\"click\", (event) => {\n      event.stopPropagation()\n      event.preventDefault()\n      openChatWidget()\n    })\n  })\n}\n\nfunction openChatWidget() {\n  window.leadConnector.chatWidget.openWidget()\n}\n\nexport const openChat = (\n  autoOpen: boolean = true,\n  elemSelector: string | undefined\n) => {\n  if (autoOpen) {\n    if (!window.leadConnector?.chatWidget?.isLoaded) {\n      openWhenChatLoads()\n    } else {\n      openChatWidget()\n    }\n  }\n  if (elemSelector) {\n    document.addEventListener(\"hydrationDone\", () => {\n      addListeners(elemSelector)\n    })\n    addListeners(elemSelector)\n  }\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAcA,SAAe,iBAAmC,GAAA;AAAA,EAAA,OAAA,OAAA,CAAA,IAAA,EAAA,IAAA,EAAA,aAAA;AAChD,IAAO,OAAA,IAAI,OAAc,CAAA,CAAC,OAAY,KAAA;AACpC,MAAM,MAAA,OAAA,GAAU,CAAC,KAAmC,KAAA;AAClD,QAAQ,OAAA,EAAA,CAAA;AACR,QAAO,MAAA,CAAA,mBAAA,CAAoB,uBAAuB,OAAO,CAAA,CAAA;AACzD,QAAe,cAAA,EAAA,CAAA;AAAA,OACjB,CAAA;AACA,MAAO,MAAA,CAAA,gBAAA,CAAiB,qBAAuB,EAAA,OAAA,EAAS,KAAK,CAAA,CAAA;AAAA,KAC9D,CAAA,CAAA;AAAA,GACH,CAAA,CAAA;AAAA,CAAA;AAEA,SAAS,aAAa,QAAkB,EAAA;AACtC,EAAA,QAAA,CAAS,gBAAiB,CAAA,QAAQ,CAAE,CAAA,OAAA,CAAQ,CAAC,EAAO,KAAA;AAClD,IAAG,EAAA,CAAA,gBAAA,CAAiB,OAAS,EAAA,CAAC,KAAU,KAAA;AACtC,MAAA,KAAA,CAAM,eAAgB,EAAA,CAAA;AACtB,MAAA,KAAA,CAAM,cAAe,EAAA,CAAA;AACrB,MAAe,cAAA,EAAA,CAAA;AAAA,KAChB,CAAA,CAAA;AAAA,GACF,CAAA,CAAA;AACH,CAAA;AAEA,SAAS,cAAiB,GAAA;AACxB,EAAO,MAAA,CAAA,aAAA,CAAc,WAAW,UAAW,EAAA,CAAA;AAC7C,CAAA;AAEO,MAAM,QAAW,GAAA,CACtB,QAAoB,GAAA,IAAA,EACpB,YACG,KAAA;AA1CL,EAAA,IAAA,EAAA,EAAA,EAAA,CAAA;AA2CE,EAAA,IAAI,QAAU,EAAA;AACZ,IAAA,IAAI,GAAC,EAAO,GAAA,CAAA,EAAA,GAAA,MAAA,CAAA,aAAA,KAAP,IAAsB,GAAA,KAAA,CAAA,GAAA,EAAA,CAAA,UAAA,KAAtB,mBAAkC,QAAU,CAAA,EAAA;AAC/C,MAAkB,iBAAA,EAAA,CAAA;AAAA,KACb,MAAA;AACL,MAAe,cAAA,EAAA,CAAA;AAAA,KACjB;AAAA,GACF;AACA,EAAA,IAAI,YAAc,EAAA;AAChB,IAAS,QAAA,CAAA,gBAAA,CAAiB,iBAAiB,MAAM;AAC/C,MAAA,YAAA,CAAa,YAAY,CAAA,CAAA;AAAA,KAC1B,CAAA,CAAA;AACD,IAAA,YAAA,CAAa,YAAY,CAAA,CAAA;AAAA,GAC3B;AACF;;;;"}