{"version":3,"file":"chat.js","sources":["../../src/js/chat.ts"],"sourcesContent":["// TODO: MOVE THIS TO IT'S OWN REPO??? ON @levelupghl org\n\n// Usage:\n// <div id=\"levelup-chat-embed\"></div>\n// <script type=\"module\">\n//   import { embedChat } from \"https://cdn.jsdelivr.net/gh/highlevelthemes/levelup@v1.7/js/components/chatEmbed.js\";\n//   embedChat();\n// </script>\n\nconst CHAT_EMBED_CONTAINER_SELECTOR = \"#levelup-chat-embed\"\nconst MAX_ATTEMPTS = 20\n\nexport const embedChat = (attempts = 1) => {\n  const embedDiv = document.querySelector(\n    CHAT_EMBED_CONTAINER_SELECTOR\n  ) as HTMLElement\n  if (!embedDiv) {\n    return\n  }\n  const retry = () => {\n    if (attempts > MAX_ATTEMPTS) {\n      console.warn(\"__theme_name__: embedChat max attempts reached\")\n      return\n    }\n    setTimeout(() => {\n      embedChat(attempts + 1)\n    }, 50 * attempts + 100)\n  }\n\n  const chat = document.querySelector(\"chat-widget\")\n  const root = chat?.shadowRoot\n\n  if (!chat || !root) {\n    return retry()\n  }\n\n  const button = root.querySelector(\".lc_text-widget--btn\") as HTMLElement\n  const widget = root.querySelector(\".lc_text-widget\") as HTMLElement\n  const box = root.querySelector(\".lc_text-widget--box\") as HTMLElement\n  const heading = root.querySelector(\n    \".lc_text-widget_heading--root\"\n  ) as HTMLElement\n\n  if (!button || !widget || !box || !heading) {\n    return retry()\n  }\n\n  chat.parentElement?.removeChild(chat)\n\n  // TODO: if mobile, don't set position: static\n  // TODO: set overscroll to auto\n\n  widget.style.position = \"static\"\n  widget.style.width = \"100%\"\n  box.style.maxWidth = \"100%\"\n  // heading.style.background = \"white\"\n\n  // TODO: wait until after button click or observe DOM before attempting to get inner-scroll\n  // const innerscroll = root\n  //   .querySelector(\"chat-pane\")\n  //   .shadowRoot.querySelector(\"chat-conversation\")\n  //   .shadowRoot.querySelector(\"ion-content\")\n  //   .shadowRoot.querySelector(\".inner-scroll\") as HTMLElement\n  // if (inner?.style) {\n  //   inner.style.overscrollBehavior = \"auto\"\n  // }\n  // TODO: set ::slotted(.informational) fontSize = 14px\n\n  embedDiv.appendChild(chat)\n\n  button?.click()\n\n  button.style.display = \"none\"\n}\n\n// CHAT MESSAGE SENT TO USER\n// <chat-message id=\"lc-chat-widget-enter-contact-details-msg\" class=\"hydrated\">\n//   <!-- #shadow-root -->\n//     <ion-item class=\"item item-has-start-slot md item-lines-none item-fill-none hydrated\">\n//       <!-- #shadow-root -->\n//         <div class=\"item-native\" part=\"native\">\n//           <slot name=\"start\"></slot>\n//           <div class=\"item-inner\">\n//             <div class=\"input-wrapper\">\n//               <slot></slot>\n//             </div>\n//             <slot name=\"end\"></slot>\n//             <div class=\"item-inner-highlight\"></div>\n//           </div>\n//           <div class=\"item-highlight\"></div>\n//         </div>\n//         <div class=\"item-bottom\">\n//           <slot name=\"error\"></slot>\n//           <slot name=\"helper\"></slot>\n//         </div>\n//       <!-- end #shadow-root -->\n//       <div class=\"message-container\" slot=\"start\">\n//         <div\n//           class=\"thumbnail-img\"\n//           style='background-image: url(\"https://widgets.leadconnectorhq.com/chat-widget/assets/defaultAvatar.png\");'\n//         ></div>\n//         <div class=\"bubble incoming bubble-footer-padding\">\n//           <slot></slot>\n//           <div class=\"triangle incoming bottom-left\"></div>\n//         </div>\n//         <div class=\"footer\">\n//           <span class=\"footer-text\">22 May, 10:46</span>\n//           <chat-message-status class=\"none hydrated\"></chat-message-status>\n//         </div>\n//       </div>\n//     </ion-item>\n//   <!-- end #shadow-root -->\n//   <p>Please enter your contact details</p>\n// </chat-message>\n\n// TINY STATUS MESSAGE - CENTERED IN CHAT WINDOW\n// <chat-message class=\"hydrated\">\n//   <!-- #shadow-root -->\n//     <ion-item class=\"item item-has-start-slot md item-lines-none item-fill-none hydrated\">\n//       <!-- #shadow-root -->\n//         <div class=\"item-native\" part=\"native\">\n//           <slot name=\"start\"></slot>\n//           <div class=\"item-inner\">\n//             <div class=\"input-wrapper\">\n//               <slot></slot>\n//             </div>\n//             <slot name=\"end\"></slot>\n//             <div class=\"item-inner-highlight\"></div>\n//           </div>\n//           <div class=\"item-highlight\"></div>\n//           <div class=\"item-bottom\">\n//             <slot name=\"error\"></slot>\n//             <slot name=\"helper\"></slot>\n//           </div>\n//         </div>\n//       <div class=\"message-container info-message-container\" slot=\"start\">\n//         <div class=\"bubble informational bubble-footer-padding\">\n//           <slot></slot>\n//         </div>\n//         <div class=\"footer\">\n//           <chat-message-status class=\"none hydrated\"></chat-message-status>\n//         </div>\n//       </div>\n//     </ion-item>\n//   <p>\n//     Our AI bot and support team are currently busy. Please leave your contact\n//     details. We will let you know when we're back online.\n//   </p>\n// </chat-message>\n\n// CHAT CONTACT FORM\n// GHL ADDS THIS TO THE CHAT WHEN IT TIMES OUT.\n// IT DOES NOT GET PRE-FILLED WITH USER DATA.\n// <chat-form class=\"hydrated\">\n//   <!-- #shadow-root -->\n//   <div id=\"lc_text-widget\">\n//     <link rel=\"stylesheet\" href=\"https://stcdn.leadconnectorhq.com/intl-tel-input/17.0.12/css/intlTelInput.min.css\">\n//     <div class=\"submit-contact-container\">\n//       <div class=\"lc_live-widget--form\">\n//         <form id=\"msgsndr_message-form\" class=\"msgsndr_message-form--hidden\">\n//           <div class=\"lc_text-widget--text-input\"><input name=\"name\" type=\"text\"\n//               class=\"lc_text-widget--text-input-input\" id=\"msgsndr_name\" required=\"\"><label\n//               for=\"msgsndr_name\">Name</label>\n//             <div class=\"lc_text-widget--text-input__Bar\"></div>\n//           </div>\n//           <div class=\"lc_text-widget--text-input\">\n//             <div class=\"iti iti--allow-dropdown\">\n//               <div class=\"iti__flag-container\">\n//                 <div class=\"iti__selected-flag\" role=\"combobox\" aria-controls=\"iti-0__country-listbox\"\n//                   aria-owns=\"iti-0__country-listbox\" aria-expanded=\"false\" tabindex=\"0\" title=\"United States: +1\"\n//                   aria-activedescendant=\"iti-0__item-us-preferred\">\n//                   <div class=\"iti__flag iti__us\"></div>\n//                   <div class=\"iti__arrow\"></div>\n//                 </div>\n//               </div><input name=\"phone\" type=\"text\" class=\"lc_text-widget--text-input-input\" id=\"msgsndr_mobile_phone\"\n//                 required=\"\" autocomplete=\"off\" data-intl-tel-input-id=\"0\"><label for=\"msgsndr_mobile_phone\"\n//                 style=\"margin-left: 54px;\">Mobile Phone</label>\n//             </div>\n//             <div class=\"lc_text-widget--text-input__Bar\"></div>\n//           </div>\n//           <div class=\"lc_text-widget--text-input\"><input name=\"email\" type=\"email\"\n//               class=\"lc_text-widget--text-input-input\" id=\"msgsndr_e-mail\" required=\"\"><label\n//               for=\"msgsndr_e-mail\">E-mail</label>\n//             <div class=\"lc_text-widget--text-input__Bar\"></div>\n//           </div>\n//         </form>\n//         <div class=\"button-container\"><ion-button\n//             class=\"md button button-small button-solid ion-activatable ion-focusable hydrated\" size=\"small\"\n//             style=\"font-size: 10px; width: fit-content;\">Send</ion-button></div>\n//       </div>\n//       <div id=\"lc-captcha\" style=\"margin-top: 10px;\"></div>\n//     </div>\n//   </div>\n// </chat-form>\n"],"names":[],"mappings":";;;;;;;;;EASA,MAAM,6BAAgC,GAAA,qBAAA,CAAA;EACtC,MAAM,YAAe,GAAA,EAAA,CAAA;AAER,QAAA,SAAA,GAAY,CAAC,QAAA,GAAW,CAAM,KAAA;EAZ3C,EAAA,IAAA,EAAA,CAAA;EAaE,EAAA,MAAM,WAAW,QAAS,CAAA,aAAA;EAAA,IACxB,6BAAA;EAAA,GACF,CAAA;EACA,EAAA,IAAI,CAAC,QAAU,EAAA;EACb,IAAA,OAAA;EAAA,GACF;EACA,EAAA,MAAM,QAAQ,MAAM;EAClB,IAAA,IAAI,WAAW,YAAc,EAAA;EAC3B,MAAA,OAAA,CAAQ,KAAK,sDAAgD,CAAA,CAAA;EAC7D,MAAA,OAAA;EAAA,KACF;EACA,IAAA,UAAA,CAAW,MAAM;EACf,MAAA,SAAA,CAAU,WAAW,CAAC,CAAA,CAAA;EAAA,KACxB,EAAG,EAAK,GAAA,QAAA,GAAW,GAAG,CAAA,CAAA;EAAA,GACxB,CAAA;EAEA,EAAM,MAAA,IAAA,GAAO,QAAS,CAAA,aAAA,CAAc,aAAa,CAAA,CAAA;EACjD,EAAA,MAAM,OAAO,IAAM,IAAA,IAAA,GAAA,KAAA,CAAA,GAAA,IAAA,CAAA,UAAA,CAAA;EAEnB,EAAI,IAAA,CAAC,IAAQ,IAAA,CAAC,IAAM,EAAA;EAClB,IAAA,OAAO,KAAM,EAAA,CAAA;EAAA,GACf;EAEA,EAAM,MAAA,MAAA,GAAS,IAAK,CAAA,aAAA,CAAc,sBAAsB,CAAA,CAAA;EACxD,EAAM,MAAA,MAAA,GAAS,IAAK,CAAA,aAAA,CAAc,iBAAiB,CAAA,CAAA;EACnD,EAAM,MAAA,GAAA,GAAM,IAAK,CAAA,aAAA,CAAc,sBAAsB,CAAA,CAAA;EACrD,EAAA,MAAM,UAAU,IAAK,CAAA,aAAA;EAAA,IACnB,+BAAA;EAAA,GACF,CAAA;EAEA,EAAA,IAAI,CAAC,MAAU,IAAA,CAAC,UAAU,CAAC,GAAA,IAAO,CAAC,OAAS,EAAA;EAC1C,IAAA,OAAO,KAAM,EAAA,CAAA;EAAA,GACf;EAEA,EAAK,CAAA,EAAA,GAAA,IAAA,CAAA,aAAA,KAAL,mBAAoB,WAAY,CAAA,IAAA,CAAA,CAAA;EAKhC,EAAA,MAAA,CAAO,MAAM,QAAW,GAAA,QAAA,CAAA;EACxB,EAAA,MAAA,CAAO,MAAM,KAAQ,GAAA,MAAA,CAAA;EACrB,EAAA,GAAA,CAAI,MAAM,QAAW,GAAA,MAAA,CAAA;EAcrB,EAAA,QAAA,CAAS,YAAY,IAAI,CAAA,CAAA;EAEzB,EAAQ,MAAA,IAAA,IAAA,GAAA,KAAA,CAAA,GAAA,MAAA,CAAA,KAAA,EAAA,CAAA;EAER,EAAA,MAAA,CAAO,MAAM,OAAU,GAAA,MAAA,CAAA;EACzB;;;;;;;;;;"}